# P&ID Smart Digitizer - 서버 아키텍처 구현 로드맵

> 사내 인트라넷용 중앙서버 방식 전환 계획

## Phase 1: 프로젝트 설정 및 기본 구조

### 1.1 백엔드 프로젝트 초기화
- [ ] `server/` 디렉토리 생성
- [ ] Node.js + Express 프로젝트 초기화
- [ ] 필요한 의존성 설치 (express, multer, sqlite3, etc.)
- [ ] TypeScript 설정 (tsconfig.json)
- [ ] 개발/프로덕션 환경 설정

### 1.2 프론트엔드 구조 분리
- [ ] `client/` 디렉토리로 기존 코드 이동
- [ ] 클라이언트 전용 빌드 설정 수정
- [ ] API 클라이언트 유틸리티 생성
- [ ] 환경변수 설정 (.env)

### 1.3 데이터베이스 설계
- [ ] SQLite 데이터베이스 스키마 설계
- [ ] 사용자 테이블 (users)
- [ ] 프로젝트 테이블 (projects)  
- [ ] 설정 테이블 (user_settings, shared_settings)
- [ ] 초기 마이그레이션 스크립트 작성

## Phase 2: 핵심 API 구현

### 2.1 파일 업로드 및 관리
- [ ] PDF 파일 업로드 API (`POST /api/upload`)
- [ ] 파일 저장 로직 구현
- [ ] 파일 메타데이터 DB 저장
- [ ] 업로드된 파일 조회 API (`GET /api/files/:id`)

### 2.2 PDF 처리 서비스
- [ ] 기존 `taggingService.ts`를 서버로 이동
- [ ] PDF 처리 API (`POST /api/process`)
- [ ] 진행상황 WebSocket 구현
- [ ] 처리 결과 저장 로직
- [ ] 오류 처리 및 로깅

### 2.3 프로젝트 관리 API
- [ ] 프로젝트 생성 API (`POST /api/projects`)
- [ ] 프로젝트 목록 조회 (`GET /api/projects`)
- [ ] 프로젝트 상세 조회 (`GET /api/projects/:id`)
- [ ] 프로젝트 저장 (`PUT /api/projects/:id`)
- [ ] 프로젝트 삭제 (`DELETE /api/projects/:id`)

## Phase 3: 사용자 관리 및 인증

### 3.1 기본 인증 시스템
- [ ] 간단한 로그인 시스템 구현
- [ ] 세션 관리 (express-session)
- [ ] 사용자 등록/로그인 API
- [ ] 인증 미들웨어 구현

### 3.2 권한 관리
- [ ] 사용자별 프로젝트 접근 권한
- [ ] 부서별 설정 공유 로직
- [ ] 관리자 권한 시스템

## Phase 4: 설정 관리 서버화

### 4.1 설정 API 구현
- [ ] 사용자 설정 저장/조회 API
- [ ] 패턴 설정 관리 (`/api/settings/patterns`)
- [ ] 허용오차 설정 관리 (`/api/settings/tolerances`)
- [ ] 앱 설정 관리 (`/api/settings/app`)

### 4.2 공유 설정 시스템
- [ ] 부서별 공통 설정 관리
- [ ] 설정 상속 로직 (개인 → 부서 → 기본값)
- [ ] 설정 템플릿 시스템

## Phase 5: 프론트엔드 API 연동

### 5.1 API 클라이언트 구현
- [ ] HTTP 클라이언트 래퍼 생성
- [ ] API 에러 처리 로직
- [ ] 로딩 상태 관리
- [ ] 오프라인 모드 처리

### 5.2 상태 관리 변경
- [ ] 로컬 스토리지 → 서버 API 전환
- [ ] 실시간 동기화 구현
- [ ] 충돌 해결 로직
- [ ] 캐싱 전략 구현

### 5.3 UI/UX 개선
- [ ] 업로드 진행률 표시
- [ ] 서버 처리 상태 표시
- [ ] 네트워크 오류 알림
- [ ] 자동 저장 기능

## Phase 6: Excel 내보내기 서버화

### 6.1 서버 사이드 Excel 생성
- [ ] `excelExporter.ts` 서버로 이동
- [ ] Excel 생성 API (`POST /api/export/excel`)
- [ ] 파일 다운로드 엔드포인트
- [ ] 대용량 파일 처리 최적화

### 6.2 내보내기 옵션
- [ ] 다양한 내보내기 형식 지원
- [ ] 사용자 정의 템플릿
- [ ] 배치 내보내기 기능

## Phase 7: 배포 및 운영

### 7.1 배포 준비
- [ ] Docker 컨테이너화
- [ ] 프로덕션 환경 설정
- [ ] 환경변수 관리
- [ ] 로그 시스템 구축

### 7.2 사내 서버 배포
- [ ] 사내 서버 환경 설정
- [ ] 데이터베이스 백업 시스템
- [ ] 모니터링 시스템
- [ ] 사용자 매뉴얼 작성

### 7.3 운영 및 유지보수
- [ ] 성능 모니터링
- [ ] 오류 추적 시스템
- [ ] 정기 백업 자동화
- [ ] 사용자 피드백 수집

## Phase 8: 고급 기능

### 8.1 협업 기능
- [ ] 실시간 협업 편집
- [ ] 댓글 및 리뷰 시스템
- [ ] 변경 이력 추적
- [ ] 버전 관리

### 8.2 성능 최적화
- [ ] 대용량 PDF 처리 최적화
- [ ] 캐싱 시스템 구현
- [ ] 데이터베이스 인덱싱
- [ ] 메모리 사용량 최적화

### 8.3 확장성
- [ ] 마이크로서비스 아키텍처 고려
- [ ] 로드 밸런싱
- [ ] 수평 확장 지원
- [ ] API 버전 관리

---

## 진행 상황 추적

- **Phase 1**: ⬜ 준비중
- **Phase 2**: ⬜ 대기중  
- **Phase 3**: ⬜ 대기중
- **Phase 4**: ⬜ 대기중
- **Phase 5**: ⬜ 대기중
- **Phase 6**: ⬜ 대기중
- **Phase 7**: ⬜ 대기중
- **Phase 8**: ⬜ 대기중

### 범례
- ⬜ 미시작
- 🔄 진행중
- ✅ 완료
- ❌ 중단/실패

---

*Last Updated: 2025-08-31*