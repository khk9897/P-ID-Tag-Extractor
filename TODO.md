# P&ID Smart Digitizer - 개발 로드맵 & TODO

## 🚀 **즉시 개선 가능한 영역**

### 1. **인식 정확도 향상**
- [🔥] **OpenCV 기반 Valve 심볼 인식**: 컴퓨터 비전으로 밸브 심볼 자동 감지 *(최우선)*
- [ ] **AI/ML 기반 태그 인식**: 현재 정규식 기반을 OpenCV나 컴퓨터 비전으로 보완
- [ ] **학습 기능**: 사용자가 수정한 내용을 학습해서 패턴 개선
- [ ] **다국어 지원**: 한국어, 일본어 P&ID 도면 지원

### 2. **사용성 개선**
- [ ] **실행취소/다시실행 (Undo/Redo)**: Ctrl+Z, Ctrl+Y 지원
- [ ] **대량 편집**: 여러 태그를 한번에 편집하는 배치 처리
- [ ] **템플릿 시스템**: 프로젝트별 패턴과 설정을 템플릿으로 저장
- [ ] **진행률 표시**: 큰 PDF 처리 시 진행상황 표시

### 3. **데이터 품질 관리**
- [ ] **중복 검출**: 동일한 태그의 중복 감지 및 병합
- [ ] **일관성 검사**: 태그명 규칙 위반 감지
- [ ] **검증 규칙**: 사용자 정의 검증 룰 설정

## 🎯 **중장기 발전 방향**

### 4. **고급 분석 기능**
- [ ] **통계 대시보드**: 태그 분포, 완성도 등 시각화
- [ ] **관계 분석**: 복잡한 연결관계 자동 추론
- [ ] **P&ID 검토 보고서**: 품질 분석 리포트 자동 생성

### 5. **협업 기능**
- [ ] **버전 관리**: Git과 유사한 변경 이력 관리
- [ ] **다중 사용자**: 여러 엔지니어가 동시 작업
- [ ] **댓글/리뷰**: 태그별 코멘트 및 승인 워크플로

### 6. **통합 확장**
- [ ] **CAD 연동**: AutoCAD, MicroStation과 연동
- [ ] **ERP 연동**: SAP, Oracle 등 기업 시스템 연계
- [ ] **API 제공**: 외부 시스템에서 활용할 수 있는 RESTful API

### 7. **성능 최적화**
- [ ] **WebAssembly**: 핵심 처리 로직을 WASM으로 최적화
- [ ] **Web Workers**: 멀티스레딩으로 대용량 처리
- [ ] **Progressive Loading**: 큰 PDF도 빠르게 로딩

## 💡 **혁신적 기능**

### 8. **AI 어시스턴트**
- [ ] **자연어 쿼리**: "압축기 태그 모두 찾아줘" 같은 자연어 검색
- [ ] **스마트 제안**: 누락된 태그나 관계 자동 제안
- [ ] **이상 감지**: 일반적이지 않은 패턴 감지

### 9. **3D 연동**
- [ ] **3D 모델 매핑**: P&ID 태그를 3D 플랜트 모델과 연결
- [ ] **AR/VR 지원**: 현장에서 AR로 태그 정보 확인

### 10. **모바일 최적화**
- [ ] **터치 인터페이스**: 태블릿에서 최적화된 조작
- [ ] **오프라인 동작**: PWA로 완전 오프라인 지원

## 📊 **우선순위별 계획**

### 🔥 **최우선: Valve 인식 시스템 (2-4주)** 
#### Phase 1: 기반 구조 (1주)
1. **OpenCV.js 통합**
   - OpenCV.js 라이브러리 추가 및 설정
   - Canvas API를 통한 PDF 페이지 이미지 추출
   - Web Worker에서 이미지 처리 파이프라인 구축

2. **Valve 카테고리 추가**
   - types.ts에 Valve 카테고리 추가
   - constants.ts에 Valve 색상 및 스타일 정의
   - UI 컴포넌트에 Valve 필터링 추가

#### Phase 2: 기본 감지 (1-2주)
3. **밸브 심볼 템플릿 생성**
   - 5가지 기본 밸브 타입 템플릿 이미지 준비
   - Gate, Ball, Check, Globe, Butterfly valve 심볼
   - 다양한 크기와 스타일 변형 고려

4. **템플릿 매칭 알고리즘**
   - OpenCV matchTemplate 함수 활용
   - Multi-scale template matching 구현
   - 회전 불변 매칭 (0°, 90°, 180°, 270°)
   - 신뢰도 임계값 기반 필터링

#### Phase 3: 통합 및 고도화 (1주)
5. **기존 시스템 통합**
   - taggingService.ts에 valve detection pass 추가
   - 기존 텍스트 기반 인식과 병행 처리
   - 중복 감지 및 병합 로직 구현

6. **UI/UX 개선**
   - Valve 태그 시각화 (🔧 아이콘)
   - 인식 정확도 신뢰도 표시
   - 수동 밸브 태그 생성 도구

### ⚡ **후순위: 기존 계획 (연기)**
1. **실행취소/다시실행 시스템** *(Valve 인식 완료 후)*
2. **대량 편집 기능** *(Valve 인식 완료 후)*  
3. **중복 검출 및 데이터 검증** *(Valve 인식과 병행 가능)*

### ⚡ **단기 목표 (1-2개월)**
1. **AI 기반 인식 정확도 향상**
   - TensorFlow.js를 활용한 OCR 보완
   - 사용자 피드백 학습 시스템
   - 패턴 매칭 알고리즘 개선

2. **템플릿 시스템**
   - 프로젝트별 설정 템플릿 저장/불러오기
   - 업계별 표준 템플릿 제공
   - 커스텀 패턴 라이브러리

3. **통계 대시보드**
   - 태그 분포 차트 (카테고리별, 페이지별)
   - 검토 진행률 시각화
   - 품질 지표 대시보드

### 🎯 **중장기 목표 (3-6개월)**
1. **협업 기능**
   - 실시간 다중 사용자 편집
   - 변경 이력 추적 및 롤백
   - 권한 기반 접근 제어

2. **CAD/ERP 연동**
   - DXF/DWG 파일 임포트
   - 표준 데이터 교환 형식 지원
   - 기업 시스템 API 연동

3. **모바일 최적화**
   - PWA 변환 및 오프라인 지원
   - 터치 최적화 UI/UX
   - 현장 작업을 위한 간소화된 인터페이스

## 🛠️ **기술적 개선사항**

### 코드 품질
- [ ] PDF.js 타입 정의 추가 (현재 TODO 항목)
- [ ] TypeScript strict 모드 완전 적용
- [ ] 테스트 커버리지 확장
- [ ] 성능 프로파일링 및 최적화

### 아키텍처 개선
- [ ] 상태 관리 라이브러리 도입 (Zustand/Redux Toolkit)
- [ ] 컴포넌트 가상화로 대용량 데이터 처리
- [ ] 에러 바운더리 및 에러 핸들링 강화
- [ ] 메모이제이션 및 렌더링 최적화

### 사용자 경험
- [ ] 로딩 스켈레톤 UI 추가
- [ ] 드래그 앤 드롭 개선
- [ ] 키보드 네비게이션 완전 지원
- [ ] 접근성 (a11y) 표준 준수

---

## 📋 **진행 상황 추적**

### ✅ **완료된 기능들**
- [x] 고급 표시 제어 시스템 (태그/관계별 세밀한 제어)
- [x] 숨겨진 요소 상호작용 보존
- [x] 반응형 헤더 레이아웃
- [x] V키 단축키로 표시 제어 패널 토글
- [x] 향상된 Line 패턴 인식 (길이 제한, 인치 기호)
- [x] PDF viewBox 오프셋 처리로 좌표 정확도 향상
- [x] 검토 상태 시스템 (체크박스 및 필터링)
- [x] 프로젝트 저장/불러오기 (JSON)
- [x] Excel 구조화 출력
- [x] 관계 관리 시스템 (6가지 관계 타입)
- [x] 다중 선택 및 영역 선택
- [x] 페이지별 필터링
- [x] 키보드 단축키 시스템

### 🚧 **진행 중**
- 현재 진행 중인 작업 없음

### ⏳ **대기 중**
- 모든 계획된 기능들이 대기 상태

---

## 💭 **아이디어 백로그**

### 사용자 피드백 기반 개선
- [ ] 사용자 행동 분석 (어떤 기능을 가장 많이 사용하는지)
- [ ] 오류 발생 패턴 분석
- [ ] 성능 병목 지점 식별

### 국제화 (i18n)
- [ ] 다국어 UI 지원 (한국어, 영어, 일본어)
- [ ] 지역별 P&ID 표준 지원
- [ ] 단위 시스템 변환 (미터법/야드파운드법)

### 클라우드 연동
- [ ] Google Drive, OneDrive 연동
- [ ] 클라우드 저장소 동기화
- [ ] 팀 공유 작업공간

---

*마지막 업데이트: 2025-01-09*
*다음 리뷰 예정: 매주 금요일*